<!DOCTYPE html>
<html>
<head>
    <title>Photo Gallery</title>
    <!-- Important for iPhone orientation / proper scaling -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <style>
        body {
            font-family: Arial;
            margin: 20px;
            background: #111;
            color: #fff;
            -webkit-touch-callout: none; /* reduce long-press options */
        }

        a.back {
            color: #4ea1ff;
            display: inline-block;
            margin-bottom: 20px;
            text-decoration: none;
        }

        /* Full-width stacked panoramas */
        .image-grid {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .image-grid img {
            width: 100%;
            height: auto;
            max-height: none;
            border-radius: 10px;
            cursor: pointer;
            object-fit: cover;
            -webkit-user-drag: none;
            user-select: none;
            -webkit-touch-callout: none;
            opacity: 0;
            animation: thumbfade 0.6s forwards;
        }

        @keyframes thumbfade {
            to { opacity: 1; }
        }

        /* LIGHTBOX OVERLAY */
        .lightbox {
            position: fixed;
            z-index: 9999;
            top: 0; left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.95);
            display: none;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            touch-action: none; /* allow JS to control gestures */
        }

        .lightbox.visible {
            display: flex;
        }

        .lightbox img {
            max-width: 100vw;
            max-height: 100vh;
            object-fit: contain;
            user-select: none;
            -webkit-user-select: none;
            -webkit-user-drag: none;
            -webkit-touch-callout: none;
            touch-action: none;
            transform-origin: 0 0;   /* top-left for easier math */
            opacity: 0;
            transition: opacity 0.25s ease-out, transform 0.15s ease-out;
        }

        /* CLOSE BUTTON (simple X top-right) */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 34px;
            color: white;
            cursor: pointer;
            z-index: 10000;
            user-select: none;
        }

        img {
            -webkit-user-drag: none;
            user-select: none;
            -webkit-touch-callout: none;
        }
    </style>
</head>

<body>

    <h1>Photo Gallery</h1>

<p style="font-size:18px; color:#ccc; text-align:center; margin-top:-10px; margin-bottom:5px;">
    For pricing on Panoramic Prints, please email unitylasting@gmail.com. 
    This includes paper, acrylic, canvas, and metal prints.
</p>

<p style="font-size:16px; color:#777; text-align:center; margin-top:0; margin-bottom:25px;">
    (C) All Rights Reserved
</p>

    <a class="back" href="index.html">← Back to 360 Tour</a>

    <!-- FULLSCREEN LIGHTBOX -->
    <div id="lightbox" class="lightbox">
        <span class="close-btn" onclick="closeLightbox()">✕</span>
        <img id="lightbox-img" src="">
    </div>

    <!-- IMAGE GRID (ORDER CONFIRMED) -->
    <div class="image-grid">
 <div class="image-grid">
    <img src="gallery/Superdome180.jpg">
    <img src="gallery/CityPark.jpg">
    <img src="gallery/NolaAtNightRiverwalk.jpg">
    <img src="gallery/SunriseOverNolaRiverwalk.jpg">
    <img src="gallery/SunriseOverTulane.jpg">
    <img src="gallery/SunsetAtUNO.jpg">
</div>

    </div>

<script>
/* IMAGE LIST (swipe order) */
const images = [
 "gallery/Superdome180.jpg",    
"gallery/CityPark.jpg",
    "gallery/NolaAtNightRiverwalk.jpg",
    "gallery/SunriseOverNolaRiverwalk.jpg",
    "gallery/SunriseOverTulane.jpg",
    "gallery/SunsetAtUNO.jpg"
];

let currentIndex = 0;
let scale = 1;
let translateX = 0;
let translateY = 0;

let panStartX = 0, panStartY = 0;
let panOriginX = 0, panOriginY = 0;

let pinchStartDist = 0;
let pinchStartScale = 1;

let swipeStartX = 0;

const lb = document.getElementById('lightbox');
const img = document.getElementById('lightbox-img');
const thumbs = document.querySelectorAll('.image-grid img');
let currentIndex = 0;
thumbs.forEach((thumb, index) => {
    thumb.addEventListener('click', () => {
        openLightbox(index);
    });
});


function updateTransform() {
    img.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
}

/* Show image and optionally fade */
function showImage(index, fade) {
    currentIndex = index;

    scale = 1;
    translateX = 0;
    translateY = 0;
    updateTransform();

    if (fade) img.style.opacity = 0;
img.src = thumbs[currentIndex].src;

    if (fade) {
        requestAnimationFrame(() => {
            img.style.opacity = 1;
        });
    } else {
        img.style.opacity = 1;
    }
}

/* OPEN LIGHTBOX */
function openLightbox(index) {
    lb.classList.add('visible');
    showImage(index, true);  // fade on open
}

/* CLOSE LIGHTBOX */
function closeLightbox() {
    lb.classList.remove('visible');
}

/* NEXT / PREVIOUS with fade */
function nextImage() {
    const next = (currentIndex + 1) % images.length;
    showImage(next, true);   // fade on swipe
}

function prevImage() {
    const prev = (currentIndex - 1 + images.length) % images.length;
    showImage(prev, true);   // fade on swipe
}

/* Prevent right-click save */
document.addEventListener('contextmenu', e => {
    if (e.target.tagName === 'IMG') e.preventDefault();
});

/* ---------------- MOUSE ZOOM (centered on pointer) ---------------- */
lb.addEventListener('wheel', function(e) {
    if (!lb.classList.contains('visible')) return;
    e.preventDefault();

    const rect = img.getBoundingClientRect();

    // Cursor position relative to image
    const cx = e.clientX - rect.left;
    const cy = e.clientY - rect.top;

    const oldScale = scale;
    let newScale = scale + e.deltaY * -0.002;
    newScale = Math.min(Math.max(1, newScale), 5);
    const scaleFactor = newScale / oldScale;

    // Adjust translation so zoom centers on cursor
    translateX = cx - scaleFactor * (cx - translateX);
    translateY = cy - scaleFactor * (cy - translateY);

    scale = newScale;
    updateTransform();
}, { passive: false });

/* ---------------- MOUSE PAN WHILE ZOOMED ---------------- */
let isPanningMouse = false;

lb.addEventListener('mousedown', function(e) {
    if (!lb.classList.contains('visible')) return;
    if (e.target !== img) return;
    if (scale <= 1) return;

    isPanningMouse = true;
    panStartX = e.clientX;
    panStartY = e.clientY;
    panOriginX = translateX;
    panOriginY = translateY;
});

window.addEventListener('mousemove', function(e) {
    if (!isPanningMouse) return;

    const dx = e.clientX - panStartX;
    const dy = e.clientY - panStartY;

    translateX = panOriginX + dx;
    translateY = panOriginY + dy;

    updateTransform();
});

window.addEventListener('mouseup', function() {
    isPanningMouse = false;
});

/* ---------------- TOUCH: SWIPE, PINCH-ZOOM, PAN ---------------- */

lb.addEventListener('touchstart', function(e) {
    if (!lb.classList.contains('visible')) return;
    if (e.target.classList.contains('close-btn')) return;

    if (e.touches.length === 1) {
        swipeStartX = e.touches[0].clientX;
        panStartX = e.touches[0].pageX;
        panStartY = e.touches[0].pageY;
        panOriginX = translateX;
        panOriginY = translateY;
    } else if (e.touches.length === 2) {
        const dx = e.touches[0].pageX - e.touches[1].pageX;
        const dy = e.touches[0].pageY - e.touches[1].pageY;
        pinchStartDist = Math.sqrt(dx*dx + dy*dy);
        pinchStartScale = scale;
    }
}, { passive: false });

lb.addEventListener('touchmove', function(e) {
    if (!lb.classList.contains('visible')) return;
    if (e.target.classList.contains('close-btn')) return;

    if (e.touches.length === 2) {
        // PINCH ZOOM around midpoint
        const x1 = e.touches[0].pageX;
        const y1 = e.touches[0].pageY;
        const x2 = e.touches[1].pageX;
        const y2 = e.touches[1].pageY;

        const dx = x1 - x2;
        const dy = y1 - y2;
        const dist = Math.sqrt(dx*dx + dy*dy);

        if (!pinchStartDist) pinchStartDist = dist;

        let newScale = pinchStartScale * (dist / pinchStartDist);
        newScale = Math.min(Math.max(1, newScale), 5);

        const rect = img.getBoundingClientRect();
        const centerX = (x1 + x2) / 2 - rect.left;
        const centerY = (y1 + y2) / 2 - rect.top;

        const oldScale = scale;
        const scaleFactor = newScale / oldScale;

        translateX = centerX - scaleFactor * (centerX - translateX);
        translateY = centerY - scaleFactor * (centerY - translateY);

        scale = newScale;
        updateTransform();
        e.preventDefault();
        return;
    }

    if (e.touches.length === 1 && scale > 1) {
        // PAN WHEN ZOOMED
        const touch = e.touches[0];
        const dx = touch.pageX - panStartX;
        const dy = touch.pageY - panStartY;

        translateX = panOriginX + dx;
        translateY = panOriginY + dy;

        updateTransform();
        e.preventDefault();
    }
}, { passive: false });

lb.addEventListener('touchend', function(e) {
    if (!lb.classList.contains('visible')) return;

    // Reset pinch reference when fingers lifted
    if (e.touches.length < 2) {
        pinchStartDist = 0;
    }

    // SWIPE left/right only when not zoomed in
    if (scale === 1 && e.changedTouches && e.changedTouches.length === 1) {
        const endX = e.changedTouches[0].clientX;
        const delta = endX - swipeStartX;

        if (Math.abs(delta) > 60) {
            if (delta < 0) nextImage();
            else          prevImage();
        }
    }
});

/* ---------------- ORIENTATION / RESIZE HANDLING ---------------- */

function resetTransformForViewport() {
    // Reset zoom/pan so image refits new orientation/size
    scale = 1;
    translateX = 0;
    translateY = 0;
    updateTransform();
}

window.addEventListener('resize', function() {
    if (lb.classList.contains('visible')) {
        resetTransformForViewport();
    }
});
</script>

</body>
</html>
