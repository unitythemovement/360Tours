<!DOCTYPE html>
<html>
<head>
    <title>Photo Gallery</title>
    <style>
        body {
            font-family: Arial;
            margin: 20px;
            background: #111;
            color: #fff;
        }

        a.back {
            color: #4ea1ff;
            display: inline-block;
            margin-bottom: 20px;
            text-decoration: none;
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .image-grid img {
            width: 100%;
            border-radius: 10px;
            cursor: pointer;
            -webkit-user-drag: none;
            user-select: none;
            opacity: 0;
            animation: fadein 0.6s forwards;
        }

        @keyframes fadein {
            to { opacity: 1; }
        }

        /* LIGHTBOX */
        .lightbox {
            display: none;
            position: fixed;
            z-index: 9999;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            justify-content: center;
            align-items: center;
            overflow: hidden;
            animation: fadein 0.4s forwards;
        }

        .lightbox img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            user-select: none;
            -webkit-user-select: none;
            -webkit-user-drag: none;
            touch-action: none;
            transform-origin: center center;
            transition: transform 0.15s ease-out;
        }

        /* CLOSE BUTTON (Option 2: Simple 'X' top-right) */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 34px;
            color: white;
            cursor: pointer;
            z-index: 10000;
            user-select: none;
        }

        img {
            -webkit-user-drag: none;
            user-select: none;
        }
    </style>
</head>

<body>

    <h1>Photo Gallery</h1>
    <a class="back" href="index.html">← Back to 360 Tour</a>

    <!-- FULLSCREEN LIGHTBOX -->
    <div id="lightbox" class="lightbox">
        <span class="close-btn" onclick="closeLightbox()">✕</span>
        <img id="lightbox-img" src="">
    </div>

    <!-- IMAGE GRID -->
    <div class="image-grid">
        <img src="gallery/CityPark.jpg" onclick="openLightbox(0)">
        <img src="gallery/NolaAtNightRiverwalk.jpg" onclick="openLightbox(1)">
        <img src="gallery/SunriseOverNolaRiverwalk.jpg" onclick="openLightbox(2)">
        <img src="gallery/SunriseOverTulane.jpg" onclick="openLightbox(3)">
        <img src="gallery/SunsetAtUNO.jpg" onclick="openLightbox(4)">
    </div>

<script>
/* IMAGE LIST (in correct swipe order) */
const images = [
    "gallery/CityPark.jpg",
    "gallery/NolaAtNightRiverwalk.jpg",
    "gallery/SunriseOverNolaRiverwalk.jpg",
    "gallery/SunriseOverTulane.jpg",
    "gallery/SunsetAtUNO.jpg"
];

let currentIndex = 0;
let scale = 1;
let lastX = 0, lastY = 0;
let startX = 0, startY = 0;
let originX = 0, originY = 0;
let initialDistance = 0;

const lb = document.getElementById('lightbox');
const img = document.getElementById('lightbox-img');

/* OPEN LIGHTBOX */
function openLightbox(index) {
    currentIndex = index;
    img.src = images[currentIndex];

    scale = 1;
    lastX = lastY = 0;
    img.style.transform = "translate(0px, 0px) scale(1)";

    lb.style.display = 'flex';
}

/* CLOSE LIGHTBOX */
function closeLightbox() {
    lb.style.display = 'none';
}

/* SWIPE HANDLING */
let touchStartX = 0;

lb.addEventListener('touchstart', e => {
    if (e.touches.length === 1) touchStartX = e.touches[0].clientX;
});

lb.addEventListener('touchend', e => {
    const endX = e.changedTouches[0].clientX;
    const delta = endX - touchStartX;

    if (Math.abs(delta) > 60 && scale === 1) {
        if (delta < 0) nextImage();
        else previousImage();
    }
});

/* NEXT/PREV FUNCTIONS */
function nextImage() {
    currentIndex = (currentIndex + 1) % images.length;
    fadeToImage(images[currentIndex]);
}

function previousImage() {
    currentIndex = (currentIndex - 1 + images.length) % images.length;
    fadeToImage(images[currentIndex]);
}

function fadeToImage(src) {
    img.style.opacity = 0;
    setTimeout(() => {
        img.src = src;
        scale = 1;
        lastX = lastY = 0;
        img.style.transform = "translate(0px,0px) scale(1)";
        img.style.opacity = 1;
    }, 150);
}

/* PREVENT SAVE METHODS */
document.addEventListener('contextmenu', e => {
    if (e.target.tagName === 'IMG') e.preventDefault();
});

document.addEventListener('dragstart', e => {
    if (e.target.tagName === 'IMG') e.preventDefault();
});

document.addEventListener('touchstart', e => {
    if (e.target.tagName === 'IMG') e.preventDefault();
}, { passive: false });

/* ZOOM + PAN */
lb.addEventListener('touchmove', function(e) {
    if (e.touches.length === 2) {
        let dx = e.touches[0].pageX - e.touches[1].pageX;
        let dy = e.touches[0].pageY - e.touches[1].pageY;
        let distance = Math.sqrt(dx*dx + dy*dy);

        if (!initialDistance) initialDistance = distance;

        scale = distance / initialDistance;
        scale = Math.min(Math.max(scale, 1), 5);

        img.style.transform = `translate(${lastX}px, ${lastY}px) scale(${scale})`;
        return;
    }

    if (e.touches.length === 1 && scale > 1) {
        let touch = e.touches[0];
        let deltaX = touch.pageX - startX;
        let deltaY = touch.pageY - startY;

        lastX = originX + deltaX;
        lastY = originY + deltaY;

        img.style.transform = `translate(${lastX}px, ${lastY}px) scale(${scale})`;
    }

    e.preventDefault();
}, { passive: false });

lb.addEventListener('touchstart', function(e) {
    if (e.touches.length === 1) {
        startX = e.touches[0].pageX;
        startY = e.touches[0].pageY;
        originX = lastX;
        originY = lastY;
    }
});

lb.addEventListener('touchend', function(e) {
    if (e.touches.length < 2) initialDistance = 0;
});

/* MOUSE ZOOM */
lb.addEventListener('wheel', function(e) {
    e.preventDefault();
